{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Desktop/Our_Stocks_Project/apps/web/src/app/api/auth/me/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport jwt from 'jsonwebtoken';\nimport { drizzle } from 'drizzle-orm/neon-http';\nimport { neon } from '@neondatabase/serverless';\nimport { pgTable, serial, text, varchar, timestamp } from 'drizzle-orm/pg-core';\nimport { eq } from 'drizzle-orm';\n\nconst users = pgTable('users', {\n  id: serial('id').primaryKey(),\n  name: text('name').notNull(),\n  email: text('email').notNull(),\n  password_hash: text('password_hash').notNull(),\n  avatar_url: text('avatar_url'),\n  role: text('role').default('user'),\n  created_at: timestamp('created_at').defaultNow(),\n  updated_at: timestamp('updated_at').defaultNow(),\n  status: varchar('status', { length: 255 }).default('active'),\n  last_login: timestamp('last_login'),\n});\n\nconst sql = neon(process.env.DATABASE_URL!);\nconst db = drizzle(sql);\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key';\n\nexport async function GET(request: NextRequest) {\n  try {\n    const authHeader = request.headers.get('authorization');\n    if (!authHeader?.startsWith('Bearer ')) {\n      return NextResponse.json({ success: false, error: 'No token' }, { status: 401 });\n    }\n\n    const decoded: any = jwt.verify(authHeader.split(' ')[1], JWT_SECRET);\n\n    const [user] = await db\n      .select({ \n        id: users.id, \n        name: users.name, \n        email: users.email, \n        role: users.role,\n        avatar_url: users.avatar_url,\n        status: users.status,\n      })\n      .from(users)\n      .where(eq(users.id, decoded.userId));\n\n    if (!user) {\n      return NextResponse.json({ success: false, error: 'User not found' }, { status: 404 });\n    }\n\n    return NextResponse.json({ success: true, data: user });\n  } catch (error: any) {\n    return NextResponse.json({ success: false, error: error.message }, { status: 401 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;AAEA,MAAM,QAAQ,IAAA,2QAAO,EAAC,SAAS;IAC7B,IAAI,IAAA,sRAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,kRAAI,EAAC,QAAQ,OAAO;IAC1B,OAAO,IAAA,kRAAI,EAAC,SAAS,OAAO;IAC5B,eAAe,IAAA,kRAAI,EAAC,iBAAiB,OAAO;IAC5C,YAAY,IAAA,kRAAI,EAAC;IACjB,MAAM,IAAA,kRAAI,EAAC,QAAQ,OAAO,CAAC;IAC3B,YAAY,IAAA,4RAAS,EAAC,cAAc,UAAU;IAC9C,YAAY,IAAA,4RAAS,EAAC,cAAc,UAAU;IAC9C,QAAQ,IAAA,wRAAO,EAAC,UAAU;QAAE,QAAQ;IAAI,GAAG,OAAO,CAAC;IACnD,YAAY,IAAA,4RAAS,EAAC;AACxB;AAEA,MAAM,MAAM,IAAA,yOAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;AACzC,MAAM,KAAK,IAAA,8QAAO,EAAC;AAEnB,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;QACvC,IAAI,CAAC,YAAY,WAAW,YAAY;YACtC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAW,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,MAAM,UAAe,2MAAG,CAAC,MAAM,CAAC,WAAW,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE;QAE1D,MAAM,CAAC,KAAK,GAAG,MAAM,GAClB,MAAM,CAAC;YACN,IAAI,MAAM,EAAE;YACZ,MAAM,MAAM,IAAI;YAChB,OAAO,MAAM,KAAK;YAClB,MAAM,MAAM,IAAI;YAChB,YAAY,MAAM,UAAU;YAC5B,QAAQ,MAAM,MAAM;QACtB,GACC,IAAI,CAAC,OACL,KAAK,CAAC,IAAA,mRAAE,EAAC,MAAM,EAAE,EAAE,QAAQ,MAAM;QAEpC,IAAI,CAAC,MAAM;YACT,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACtF;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAK;IACvD,EAAE,OAAO,OAAY;QACnB,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF"}}]
}