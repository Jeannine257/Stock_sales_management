{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PC/Desktop/Our_Stocks_Project/apps/web/src/app/api/admin/activity/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { drizzle } from 'drizzle-orm/neon-http';\nimport { neon } from '@neondatabase/serverless';\nimport { pgTable, serial, text, integer, timestamp, jsonb } from 'drizzle-orm/pg-core';\nimport { desc, eq } from 'drizzle-orm';\n\nconst activityLogs = pgTable('activity_logs', {\n  id: serial('id').primaryKey(),\n  user_id: integer('user_id'),\n  action_type: text('action_type').notNull(),\n  description: text('description').notNull(),\n  entity_type: text('entity_type'),\n  entity_id: integer('entity_id'),\n  metadata: jsonb('metadata'),\n  created_at: timestamp('created_at').defaultNow(),\n});\n\nconst users = pgTable('users', {\n  id: serial('id').primaryKey(),\n  name: text('name').notNull(),\n  email: text('email').notNull(),\n});\n\nconst sqlClient = neon(process.env.DATABASE_URL!);\nconst db = drizzle(sqlClient);\n\nexport const dynamic = 'force-dynamic';\n\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const limit = parseInt(searchParams.get('limit') || '10');\n\n    const activities = await db\n      .select({\n        id: activityLogs.id,\n        user_id: activityLogs.user_id,\n        action_type: activityLogs.action_type,\n        description: activityLogs.description,\n        entity_type: activityLogs.entity_type,\n        entity_id: activityLogs.entity_id,\n        metadata: activityLogs.metadata,\n        created_at: activityLogs.created_at,\n        user: {\n          id: users.id,\n          name: users.name,\n          email: users.email,\n        },\n      })\n      .from(activityLogs)\n      .leftJoin(users, eq(activityLogs.user_id, users.id))\n      .orderBy(desc(activityLogs.created_at))\n      .limit(limit);\n\n    return NextResponse.json({ success: true, data: activities });\n  } catch (error: any) {\n    console.error('Error fetching activity logs:', error);\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;;;;;;AAEA,MAAM,eAAe,IAAA,2QAAO,EAAC,iBAAiB;IAC5C,IAAI,IAAA,sRAAM,EAAC,MAAM,UAAU;IAC3B,SAAS,IAAA,wRAAO,EAAC;IACjB,aAAa,IAAA,kRAAI,EAAC,eAAe,OAAO;IACxC,aAAa,IAAA,kRAAI,EAAC,eAAe,OAAO;IACxC,aAAa,IAAA,kRAAI,EAAC;IAClB,WAAW,IAAA,wRAAO,EAAC;IACnB,UAAU,IAAA,oRAAK,EAAC;IAChB,YAAY,IAAA,4RAAS,EAAC,cAAc,UAAU;AAChD;AAEA,MAAM,QAAQ,IAAA,2QAAO,EAAC,SAAS;IAC7B,IAAI,IAAA,sRAAM,EAAC,MAAM,UAAU;IAC3B,MAAM,IAAA,kRAAI,EAAC,QAAQ,OAAO;IAC1B,OAAO,IAAA,kRAAI,EAAC,SAAS,OAAO;AAC9B;AAEA,MAAM,YAAY,IAAA,yOAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;AAC/C,MAAM,KAAK,IAAA,8QAAO,EAAC;AAEZ,MAAM,UAAU;AAEhB,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,QAAQ,SAAS,aAAa,GAAG,CAAC,YAAY;QAEpD,MAAM,aAAa,MAAM,GACtB,MAAM,CAAC;YACN,IAAI,aAAa,EAAE;YACnB,SAAS,aAAa,OAAO;YAC7B,aAAa,aAAa,WAAW;YACrC,aAAa,aAAa,WAAW;YACrC,aAAa,aAAa,WAAW;YACrC,WAAW,aAAa,SAAS;YACjC,UAAU,aAAa,QAAQ;YAC/B,YAAY,aAAa,UAAU;YACnC,MAAM;gBACJ,IAAI,MAAM,EAAE;gBACZ,MAAM,MAAM,IAAI;gBAChB,OAAO,MAAM,KAAK;YACpB;QACF,GACC,IAAI,CAAC,cACL,QAAQ,CAAC,OAAO,IAAA,mRAAE,EAAC,aAAa,OAAO,EAAE,MAAM,EAAE,GACjD,OAAO,CAAC,IAAA,iRAAI,EAAC,aAAa,UAAU,GACpC,KAAK,CAAC;QAET,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAW;IAC7D,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF"}}]
}